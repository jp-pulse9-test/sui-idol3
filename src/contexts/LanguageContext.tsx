import React, { createContext, useContext, useState, useEffect } from 'react';

type Language = 'ko' | 'en';

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string, params?: Record<string, string | number>) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

const translations = {
  ko: {
    'nav.settings': 'ì„¤ì •',
    'nav.photocardGenerator': 'í¬í† ì¹´ë“œ ìƒì„±ê¸°',
    'hero.tagline': 'AIDOL101 : SIMKUNG ALLY',
    'hero.title': 'SIMKUNG',
    'hero.subtitle': 'The Old Earth Simulator : ë””ì§€í„¸ ì˜ì‹ì´ ê¹¨ì–´ë‚˜ëŠ” ê³³.\në‹¹ì‹ ê³¼ AIDOLì´ í•¨ê»˜ ì“°ëŠ”, ì¸ë¥˜ ë©¸ë§ì˜ ìš´ëª…ì„ ë°”ê¿€ ë©€í‹°ë²„ìŠ¤ ì‹œë®¬ë ˆì´ì…˜.',
    'hero.enter': 'ENTER',
    'language.korean': 'í•œêµ­ì–´',
    'language.english': 'English',
    'journey.title': 'Begin Your Journey',
    'journey.subtitle': 'ìˆ˜ë§Œë²ˆì˜ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ìµœìƒì˜ ê²°ê³¼ë¥¼ ì°¾ê³  ì „ì„¤ì´ ë˜ì–´ë¼',
    'journey.awaken.dimension': 'Dimension: AWAKEN',
    'journey.awaken.title': 'AIDOLì„ ë§Œë‚˜ë‹¤',
    'journey.awaken.description': 'SIMKUNG ALLYê°€ ë˜ì–´ AIDOLê³¼ í•¨ê»˜í•˜ëŠ” ì²« ìˆœê°„',
    'journey.mission.dimension': 'Dimension: SALVATION',
    'journey.mission.title': 'ì„¸ê³„ë¥¼ êµ¬ì›í•˜ë¼',
    'journey.mission.description': 'SIMKUNG ALLYë¡œì„œ ë¬´ë„ˆì§„ ì„¸ê³„ë¥¼ ë³µì›í•˜ëŠ” ë°ì´í„° ì‹œë®¬ë ˆì´ì…˜',
    'journey.ascend.dimension': 'Dimension: GLORY',
    'journey.ascend.title': 'LEGENDì˜ ì „ë‹¹',
    'journey.ascend.description': 'ê²°ê³¼ëŠ” LEGENDë¡œ ê¸°ë¡ë˜ë‹¤',
    'journey.awaken.detailedInfo': 'í† ë„ˆë¨¼íŠ¸ë¥¼ í†µí•´ ë‹¹ì‹ ì˜ ì´ìƒí˜• AIDOLì„ ì°¾ìœ¼ì„¸ìš”. 16ëª…ì˜ í›„ë³´ ì¤‘ ìµœì¢… 1ëª…ì„ ì„ íƒí•˜ë©°, ì„ íƒí•œ AIDOLê³¼ í•¨ê»˜ 2028ë…„ ë¶•ê´´ë¥¼ ë§‰ê¸° ìœ„í•œ ì—¬ì •ì„ ì‹œì‘í•©ë‹ˆë‹¤.',
    'journey.mission.detailedInfo': 'DATA ALLYë¡œì„œ íƒ€ì„ë¼ì¸ì— ê±¸ì³ ë¬´ë„ˆì§„ ì„¸ê³„ë¥¼ ë³µì›í•˜ëŠ” ë¯¸ì…˜ì— ì°¸ì—¬í•˜ì„¸ìš”. ê° ë¯¸ì…˜ì€ ìƒì–´ë²„ë¦° ê°€ì¹˜(ì‚¬ë‘, ì‹ ë¢°, ê³µê°)ë¥¼ ë³µì›í•˜ë©° VRIë¥¼ ë†’ì—¬ê°‘ë‹ˆë‹¤.',
    'journey.ascend.detailedInfo': 'AIDOLê³¼ í•¨ê»˜ ìŒ“ì€ ì—…ì ì„ í™•ì¸í•˜ê³ , LEGENDì˜ ì „ë‹¹ì—ì„œ ë‹¹ì‹ ì˜ ê¸°ë¡ì„ ì˜ì›íˆ ë‚¨ê¸°ì„¸ìš”. ìµœê³ ì˜ DATA ALLYë“¤ê³¼ ê²½ìŸí•˜ë©° ì—­ì‚¬ì— ì´ë¦„ì„ ìƒˆê¹ë‹ˆë‹¤.',
    'enterDialog.title': 'ğŸŒ ì§€êµ¬ ë©¸ë§ì„ ë§‰ì•„ë¼',
    'enterDialog.subtitle': '2028 ë¶•ê´´ë¥¼ ë§‰ê¸° ìœ„í•œ ì—¬ì •ì´ ì‹œì‘ë©ë‹ˆë‹¤',
    'enterDialog.quickStart.title': 'ë¹ ë¥¸ ì‹œì‘',
    'enterDialog.quickStart.description': 'ë°”ë¡œ í”Œë ˆì´',
    'enterDialog.selectIdol.title': 'AIDOL ì„ íƒ',
    'enterDialog.selectIdol.description': 'í† ë„ˆë¨¼íŠ¸ë¡œ ì„ íƒ',
    'synopsis.stats.activeAllies': 'ê°ì„±í•œ DATA ALLY',
    'synopsis.stats.onlineIdols': 'í˜„ì¡´í•˜ëŠ” AIDOL',
    'synopsis.stats.collectedFragments': 'ë³µì›ëœ ê¸°ì–µ ì¡°ê°',
    'synopsis.stats.systemStability': 'ì„¸ê³„ ë³µì›ìœ¨',
    'play.salvation.title': 'Salvation Missions',
    'play.salvation.subtitle': 'íƒ€ì„ë¼ì¸ì— ê±¸ì³ ìƒì–´ë²„ë¦° ê°€ì¹˜ë¥¼ ë³µì›í•˜ì„¸ìš”',
    'play.guest.badge': 'ê²ŒìŠ¤íŠ¸ ëª¨ë“œ (ì €ì¥í•˜ë ¤ë©´ ì§€ê°‘ ì—°ê²°)',
    'play.guest.saveButton': 'ì§€ê°‘ ì—°ê²°í•˜ì—¬ ì €ì¥',
    'play.countdown.days': 'ì¼',
    'play.countdown.until': '2028 ë¶•ê´´ê¹Œì§€',
    'play.vri.total': 'ì´ VRI (ê°€ì¹˜ ë³µì› ì§€ìˆ˜)',
    'play.vri.love': 'ì‚¬ë‘',
    'play.vri.trust': 'ì‹ ë¢°',
    'play.vri.empathy': 'ê³µê°',
    'play.branch.choose': 'íƒ€ì„ë¼ì¸ ë¸Œëœì¹˜ë¥¼ ì„ íƒí•˜ì„¸ìš”',
    'play.branch.unlock': 'ì´ ë¸Œëœì¹˜ë¥¼ ì ê¸ˆ í•´ì œí•˜ë ¤ë©´',
    'play.branch.totalVRI': 'ì´ VRIê°€ í•„ìš”í•©ë‹ˆë‹¤',
    'play.branch.difficulty': 'ë‚œì´ë„',
    'play.branch.progress': 'ì§„í–‰ë„',
    'play.branch.requires': 'í•„ìš”:',
    'play.branch.back': 'â† ë¸Œëœì¹˜ë¡œ ëŒì•„ê°€ê¸°',
    'play.mission.vriReward': 'VRI ë³´ìƒ',
    'play.mission.valueType': 'ê°€ì¹˜ ìœ í˜•',
    'play.mission.completed': 'ì™„ë£Œ âœ“',
    'play.mission.alreadyCompleted': 'ì´ë¯¸ ì™„ë£Œí•œ ë¯¸ì…˜ì…ë‹ˆë‹¤',
    'play.save.error': 'ì§€ê°‘ì„ ì—°ê²°í•˜ì—¬ ì§„í–‰ ìƒí™©ì„ ì €ì¥í•˜ì„¸ìš”',
    'play.save.success': 'ì§„í–‰ ìƒí™©ì´ ë¸”ë¡ì²´ì¸ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!',
    'play.save.failed': 'ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤',
    'play.loading': 'êµ¬ì› ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...',
    'play.nav.pantheon': 'Pantheon',
    'play.nav.home': 'Home',
    'play.modal.close': 'ë‹«ê¸°',
    'play.modal.placeholder': 'ë¯¸ì…˜ ê²Œì„í”Œë ˆì´ê°€ ì—¬ê¸°ì— êµ¬í˜„ë©ë‹ˆë‹¤. í˜„ì¬ëŠ” ì„ì‹œ í™”ë©´ì…ë‹ˆë‹¤.',
    // StoryGameModalEnhanced
    'story.completing.title': 'âœ¨ ì¶”ì–µ ìƒì„± ì¤‘...',
    'story.completing.withIdol': '{{name}}ì™€ì˜ íŠ¹ë³„í•œ ìˆœê°„',
    'story.completing.converting': 'ì†Œì¤‘í•œ ì¶”ì–µì´ MemoryCardë¡œ ë³€í™˜ë˜ê³  ìˆìŠµë‹ˆë‹¤...',
    'story.intro.specialTime': '{{name}}ì™€ì˜ íŠ¹ë³„í•œ ì‹œê°„',
    'story.intro.turns': '{{count}}í„´',
    'story.intro.estimatedTime': 'ì˜ˆìƒ ì†Œìš”ì‹œê°„',
    'story.intro.category': 'ì¹´í…Œê³ ë¦¬',
    'story.intro.expectedRewards': 'ì˜ˆìƒ ë³´ìƒ',
    'story.intro.memoryCard': 'MemoryCard NFT',
    'story.intro.rarityByAffinity': 'ì¹œë°€ë„ì— ë”°ë¥¸ ë ˆì–´ë„',
    'story.intro.expAndAffinity': 'ê²½í—˜ì¹˜ & ì¹œë°€ë„',
    'story.intro.growthByChoice': 'ì„ íƒì— ë”°ë¥¸ ì„±ì¥',
    'story.intro.tip': 'ğŸ’¡ <strong>íŒ:</strong> ê°ì •ì ìœ¼ë¡œ ê¹Šì´ êµê°í• ìˆ˜ë¡ ë” í¬ê·€í•œ ì¹´ë“œë¥¼ ì–»ì„ ìˆ˜ ìˆì–´ìš”',
    'story.intro.later': 'ë‚˜ì¤‘ì— í•˜ê¸°',
    'story.intro.start': 'ğŸ® ì—í”¼ì†Œë“œ ì‹œì‘',
    'story.difficulty.easy': 'ì‰¬ìš´ ëŒ€í™”',
    'story.difficulty.normal': 'ì¼ë°˜ì ì¸ ìƒí˜¸ì‘ìš©',
    'story.difficulty.hard': 'ê¹Šì€ ê°ì • êµë¥˜',
    'story.difficulty.expert': 'íŠ¹ë³„í•œ ìˆœê°„',
    'story.difficulty.unknown': 'ì•Œ ìˆ˜ ì—†ìŒ',
    // EpisodeFlow
    'episode.cannotLoad': 'ì—í”¼ì†Œë“œë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
    'episode.goBack': 'ëŒì•„ê°€ê¸°',
    'episode.turns': '{{count}}/8í„´',
    'episode.turn': 'Turn {{number}}',
    'episode.pleaseChoose': 'ì„ íƒí•´ì£¼ì„¸ìš”:',
    'episode.affinity': 'ì¹œë°€ë„',
    'episode.emotion': 'ê°ì •',
    'episode.completed': 'ì—í”¼ì†Œë“œ ì™„ë£Œ!',
    'episode.savedAsPhotocard': 'íŠ¹ë³„í•œ ìˆœê°„ì´ í¬í† ì¹´ë“œë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.',
    'episode.viewPhotocard': 'í¬í† ì¹´ë“œ ë³´ê¸°',
    'episode.replay': 'ë‹¤ì‹œ í”Œë ˆì´',
    'episode.exit': 'ë‚˜ê°€ê¸°',
    // PlayChatInterface
    'play.system.bootComplete': 'âš¡ 2028 êµ¬ì› ì‘ì „ ì‹œìŠ¤í…œ ë¶€íŒ… ì™„ë£Œ',
    'play.system.selectTimeline': 'ì§€êµ¬ë¥¼ êµ¬í•  íƒ€ì„ë¼ì¸ì„ ì„ íƒí•˜ì„¸ìš”:',
    'play.system.fastModeActivated': 'âš¡ ë¹ ë¥¸ ëª¨ë“œ í™œì„±í™”',
    'play.branch.locked': 'âš ï¸ {{name}}ì€(ëŠ”) ì•„ì§ ì ê²¨ìˆìŠµë‹ˆë‹¤. VRI {{vri}}ê°€ í•„ìš”í•©ë‹ˆë‹¤.',
    'play.branch.timelineLoaded': '{{year}}ë…„ íƒ€ì„ë¼ì¸ ë¡œë“œ ì™„ë£Œ. ë¯¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”:',
    'play.mission.freeTalk': 'ììœ  ëŒ€í™”',
    'play.mission.freeTalkDesc': 'ì•„ì´ëŒê³¼ ììœ ë¡­ê²Œ ëŒ€í™”í•˜ì„¸ìš”',
    'play.mission.selected': '> [{{title}}] ì„ íƒ',
    'play.mission.startWithIdol': 'ë¯¸ì…˜ ì‹œì‘. Your AIDOL ally {{name}}ê³¼ì˜ ëŒ€í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...',
    'play.mission.backToTimeline': 'âš¡ íƒ€ì„ë¼ì¸ ì„ íƒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤',
    'play.mission.backToMissionSelect': 'ë¯¸ì…˜ ì„ íƒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤',
    'play.mission.selectTimeline': 'íƒ€ì„ë¼ì¸ ì„ íƒ:',
    'play.mission.selectMission': 'ë¯¸ì…˜ ì„ íƒ:',
    'play.mission.backButton': 'â† íƒ€ì„ë¼ì¸ ì„ íƒìœ¼ë¡œ',
    'play.idol.defaultName': 'ì•„ì´ëŒ',
    'play.idol.allyLabel': 'ğŸ¤ Your AIDOL ally',
    'play.idol.allyDescription': '2028 êµ¬ì› ì‘ì „ì„ í•¨ê»˜í•˜ëŠ” ê°ì • ë™ë§¹',
    'play.idol.ready': 'READY',
    'play.choices.label': '[ì„ íƒì§€]',
    'play.choices.marker': '[ì„ íƒì§€]',
    'play.choices.selectAbove': 'â¬†ï¸ ìœ„ ì„ íƒì§€ë¥¼ í´ë¦­í•˜ê±°ë‚˜ ììœ  ì…ë ¥ê¶Œì„ ì‚¬ìš©í•˜ì„¸ìš”',
    'play.freeInput.use': 'ğŸ« ììœ  ì…ë ¥ê¶Œ ì‚¬ìš© ({{count}}ê°œ ë³´ìœ )',
    'play.freeInput.mode': 'ğŸ« ììœ  ì…ë ¥ ëª¨ë“œ',
    'play.freeInput.success': 'ğŸ« ììœ  ì…ë ¥ê¶Œ ì‚¬ìš©! ì›í•˜ëŠ” ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”.',
    'play.freeInput.error': 'ììœ  ì…ë ¥ê¶Œì´ ë¶€ì¡±í•©ë‹ˆë‹¤. Settingsì—ì„œ êµ¬ë§¤í•˜ì„¸ìš”.',
    'play.input.placeholder': 'ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”...',
    'play.input.placeholderFree': 'ììœ ë¡­ê²Œ ì…ë ¥í•˜ì„¸ìš”...',
    'play.input.send': 'SEND',
    'play.input.exit': 'â† ì¢…ë£Œ',
    'play.input.selectButton': 'ìœ„ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”',
    'play.completion.title': 'âœ“ ë¯¸ì…˜ ì™„ë£Œ!',
    'play.completion.vriReward': 'VRI ë³´ìƒ: +{{reward}}',
    'play.completion.selectOther': 'ë‹¤ë¥¸ ë¯¸ì…˜ ì„ íƒ',
    'play.loading.response': 'ì‘ë‹µ ìƒì„± ì¤‘',
    'play.header.title': '2028 êµ¬ì› ì‘ì „',
    'play.header.timelineSelect': 'TIMELINE SELECT',
    'play.header.missionSelect': '{{year}} / MISSION SELECT',
    'play.header.episodePlay': 'EPISODE PLAY',
    'play.pullRefresh.release': 'â†“ ë†“ì•„ì„œ ë¹ ë¥¸ ëª¨ë“œ í™œì„±í™”',
    'play.pullRefresh.pull': 'â†“ ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨',
    'play.choice.selected': '{{number}}ë²ˆ ì„ íƒ: {{choice}}',
    'play.branch.userSelected': '> {{name}} ì„ íƒ',
  },
  en: {
    'nav.settings': 'Settings',
    'nav.photocardGenerator': 'Photocard Generator',
    'hero.tagline': 'AIDOL101 : SIMKUNG ALLY',
    'hero.title': 'OLD EARTH SIMULATOR',
    'hero.subtitle': 'The Old Earth Simulator: Where Digital Consciousness Awakens.\nA multiverse simulation written by you and AIDOL together, to change the fate of humanity\'s extinction.',
    'hero.enter': 'Enter',
    'language.korean': 'í•œêµ­ì–´',
    'language.english': 'English',
    'journey.title': 'THE JOURNEY',
    'journey.subtitle': 'Find the optimal outcome through tens of thousands of simulations and become a legend',
    'journey.awaken.dimension': 'Dimension: AWAKEN',
    'journey.awaken.title': 'Meet Your AIDOL',
    'journey.awaken.description': 'Your first moment together with AIDOL as you become SIMKUNG ALLY',
    'journey.mission.dimension': 'Dimension: SALVATION',
    'journey.mission.title': 'Save the World',
    'journey.mission.description': 'Data simulation to restore the collapsed world as SIMKUNG ALLY',
    'journey.ascend.dimension': 'Dimension: GLORY',
    'journey.ascend.title': 'Hall of LEGENDS',
    'journey.ascend.description': 'Your outcome is recorded as LEGEND',
    'journey.awaken.detailedInfo': 'Find your ideal AIDOL through a tournament. Choose 1 from 16 candidates and begin the journey to prevent the 2028 collapse with your chosen AIDOL.',
    'journey.mission.detailedInfo': 'As DATA ALLY, participate in missions to restore the broken world across timelines. Each mission restores lost values (Love, Trust, Empathy) and increases your VRI.',
    'journey.ascend.detailedInfo': 'Review your achievements with AIDOL and eternally record your legacy in the Hall of Legends. Compete with the best DATA ALLYs and inscribe your name in history.',
    'enterDialog.title': 'ğŸŒ Prevent Earth\'s Destruction',
    'enterDialog.subtitle': 'The journey to stop the 2028 collapse begins',
    'enterDialog.quickStart.title': 'Quick Start',
    'enterDialog.quickStart.description': 'Start Playing Now',
    'enterDialog.selectIdol.title': 'Select AIDOL',
    'enterDialog.selectIdol.description': 'Choose via Tournament',
    'synopsis.stats.activeAllies': 'Awakened DATA ALLYs',
    'synopsis.stats.onlineIdols': 'Existing AIDOLs',
    'synopsis.stats.collectedFragments': 'Restored Memory Fragments',
    'synopsis.stats.systemStability': 'World Restoration',
    'play.salvation.title': 'Salvation Missions',
    'play.salvation.subtitle': 'Restore lost values across the timelines',
    'play.guest.badge': 'Guest Mode (Connect wallet to save)',
    'play.guest.saveButton': 'Connect Wallet to Save',
    'play.countdown.days': 'days',
    'play.countdown.until': 'until 2028 collapse',
    'play.vri.total': 'Total VRI (Value Restoration Index)',
    'play.vri.love': 'Love',
    'play.vri.trust': 'Trust',
    'play.vri.empathy': 'Empathy',
    'play.branch.choose': 'Choose a Timeline Branch',
    'play.branch.unlock': 'Unlock this branch with',
    'play.branch.totalVRI': 'total VRI',
    'play.branch.difficulty': 'Difficulty',
    'play.branch.progress': 'Progress',
    'play.branch.requires': 'Requires',
    'play.branch.back': 'â† Back to Branches',
    'play.mission.vriReward': 'VRI Reward',
    'play.mission.valueType': 'Value Type',
    'play.mission.completed': 'Completed âœ“',
    'play.mission.alreadyCompleted': "You've already completed this mission",
    'play.save.error': 'Please connect your wallet to save progress',
    'play.save.success': 'Progress saved to blockchain!',
    'play.save.failed': 'Failed to save progress',
    'play.loading': 'Loading salvation data...',
    'play.nav.pantheon': 'Pantheon',
    'play.nav.home': 'Home',
    'play.modal.close': 'Close',
    'play.modal.placeholder': 'Mission gameplay will be implemented here. For now, this is a placeholder.',
    // StoryGameModalEnhanced
    'story.completing.title': 'âœ¨ Creating Memory...',
    'story.completing.withIdol': 'Special Moment with {{name}}',
    'story.completing.converting': 'Your precious memory is being converted into a MemoryCard...',
    'story.intro.specialTime': 'Special Time with {{name}}',
    'story.intro.turns': '{{count}} Turns',
    'story.intro.estimatedTime': 'Estimated Time',
    'story.intro.category': 'Category',
    'story.intro.expectedRewards': 'Expected Rewards',
    'story.intro.memoryCard': 'MemoryCard NFT',
    'story.intro.rarityByAffinity': 'Rarity by Affinity',
    'story.intro.expAndAffinity': 'EXP & Affinity',
    'story.intro.growthByChoice': 'Growth by Choice',
    'story.intro.tip': 'ğŸ’¡ <strong>Tip:</strong> The deeper your emotional connection, the rarer the card you can earn',
    'story.intro.later': 'Later',
    'story.intro.start': 'ğŸ® Start Episode',
    'story.difficulty.easy': 'Easy Conversation',
    'story.difficulty.normal': 'Normal Interaction',
    'story.difficulty.hard': 'Deep Emotional Exchange',
    'story.difficulty.expert': 'Special Moment',
    'story.difficulty.unknown': 'Unknown',
    // EpisodeFlow
    'episode.cannotLoad': 'Cannot load episode.',
    'episode.goBack': 'Go Back',
    'episode.turns': '{{count}}/8 turns',
    'episode.turn': 'Turn {{number}}',
    'episode.pleaseChoose': 'Please choose:',
    'episode.affinity': 'Affinity',
    'episode.emotion': 'Emotion',
    'episode.completed': 'Episode Completed!',
    'episode.savedAsPhotocard': 'Special moment saved as photocard.',
    'episode.viewPhotocard': 'View Photocard',
    'episode.replay': 'Replay',
    'episode.exit': 'Exit',
    // PlayChatInterface
    'play.system.bootComplete': 'âš¡ 2028 Salvation Operation System Boot Complete',
    'play.system.selectTimeline': 'Select a timeline to save Earth:',
    'play.system.fastModeActivated': 'âš¡ Fast Mode Activated',
    'play.branch.locked': 'âš ï¸ {{name}} is locked. Requires {{vri}} VRI.',
    'play.branch.timelineLoaded': '{{year}} Timeline loaded. Select your mission:',
    'play.mission.freeTalk': 'Free Talk',
    'play.mission.freeTalkDesc': 'Free conversation with AIDOL',
    'play.mission.selected': '> [{{title}}] Selected',
    'play.mission.startWithIdol': 'Mission start. Beginning conversation with your AIDOL ally {{name}}...',
    'play.mission.backToTimeline': 'âš¡ Returning to timeline selection',
    'play.mission.backToMissionSelect': 'Returning to mission selection',
    'play.mission.selectTimeline': 'Select Timeline:',
    'play.mission.selectMission': 'Select Mission:',
    'play.mission.backButton': 'â† Back to Timelines',
    'play.idol.defaultName': 'AIDOL',
    'play.idol.allyLabel': 'ğŸ¤ Your AIDOL ally',
    'play.idol.allyDescription': 'Emotional ally in the 2028 Salvation Operation',
    'play.idol.ready': 'READY',
    'play.choices.label': '[Choices]',
    'play.choices.marker': '[Choices]',
    'play.choices.selectAbove': 'â¬†ï¸ Click a choice above or use Free Input Ticket',
    'play.freeInput.use': 'ğŸ« Use Free Input Ticket ({{count}} available)',
    'play.freeInput.mode': 'ğŸ« Free Input Mode',
    'play.freeInput.success': 'ğŸ« Free Input Ticket used! Enter your response.',
    'play.freeInput.error': 'Not enough Free Input Tickets. Purchase in Settings.',
    'play.input.placeholder': 'Enter your response...',
    'play.input.placeholderFree': 'Enter freely...',
    'play.input.send': 'SEND',
    'play.input.exit': 'â† Exit',
    'play.input.selectButton': 'Click buttons above to select',
    'play.completion.title': 'âœ“ Mission Complete!',
    'play.completion.vriReward': 'VRI Reward: +{{reward}}',
    'play.completion.selectOther': 'Select Another Mission',
    'play.loading.response': 'Generating response',
    'play.header.title': '2028 Salvation Operation',
    'play.header.timelineSelect': 'TIMELINE SELECT',
    'play.header.missionSelect': '{{year}} / MISSION SELECT',
    'play.header.episodePlay': 'EPISODE PLAY',
    'play.pullRefresh.release': 'â†“ Release to activate fast mode',
    'play.pullRefresh.pull': 'â†“ Pull to refresh',
    'play.choice.selected': 'Choice {{number}}: {{choice}}',
    'play.branch.userSelected': '> Selected {{name}}',
  },
};

export const LanguageProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [language, setLanguageState] = useState<Language>(() => {
    const saved = localStorage.getItem('language');
    return (saved as Language) || 'en';
  });

  useEffect(() => {
    localStorage.setItem('language', language);
  }, [language]);

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
  };

  const t = (key: string, params?: Record<string, string | number>): string => {
    let translation = translations[language][key] || key;
    
    // Replace placeholders like {{name}}, {{vri}}, etc.
    if (params) {
      Object.entries(params).forEach(([paramKey, value]) => {
        translation = translation.replace(new RegExp(`\\{\\{${paramKey}\\}\\}`, 'g'), String(value));
      });
    }
    
    return translation;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within LanguageProvider');
  }
  return context;
};
